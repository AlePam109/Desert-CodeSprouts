<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Desert CodeSprouts - Cybersecurity Game</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <canvas id="matrixCanvas"></canvas>
  <img id="catImage" src="cat.png" alt="Cat Mascot" />
  <div id="instructionsButton" onclick="toggleInstructions()">Instructions</div>

  <div id="instructionsModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="toggleInstructions()">&times;</span>
      <h2>Instructions</h2>
      <div class="instructions-content">
        <h3>Task 1: Breaking the Substitution Cipher</h3>
        <p>In cryptography, a substitution cipher is a method of encrypting by which units of plaintext are replaced with ciphertext according to a fixed system.</p>
        <p>Your task is to break the cipher by:</p>
        <ol>
          <li>Analyzing the frequency of words in the encrypted text</li>
          <li>Guessing letter mappings based on common words in the English language</li>
        </ol>
        <p>Tips:</p>
        <ul>
          <li>Check the common words in the English language like "THE", "WILL", "THAT" etc.</li>
          <li>Common word endings include -ing, -ed, -tion</li>
        </ul>
        <h3>Task 2: Finding a Hash Collision</h3>
        <p>A hash function transforms any input into a fixed length output</p>
        <ol>
          <li>Identify the hash function by trying different inputs</li>
          <li>Modify the decrypted plaintext message, such that the hash remains the same</li>
        </ol>
        <h3>Task 3: Launch a DDoS attack</h3>
        <p>We need to send lots of HTTP requests to the Black Dawn's communication's server to make it unavailable</p>
        <p>Python tips and tricks:</p>
        <ol>
          <li>Prepare the URL string. The IP address is IP_ADDR</li>
          <li>use the "send_http_request(URL)" function to send the HTTP request</li>
          <li>A for loop can be used to send a request multiple times</li>
        </ol>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="game-header">
      <h1 class="glitch-title">Substitution Cipher Challenge</h1>
    </div>

    <!-- Challenge section -->
    <div class="challenge-section">
      <h2>Challenge #1</h2>
      <div class="challenge-text" id="challengeText">
        <!-- Challenge text will be inserted here -->
      </div>
      <button id="nextChallenge" class="hidden">Next Challenge</button>
    </div>

    <!-- Input box for encryption -->
    <textarea id="inputText" placeholder="Type here to encrypt or decrypt..."></textarea>
    <!-- Output box appears at the top -->
    <div class="output-container">
      <label>Encrypted/Decrypted Output:</label>
      <div id="outputText" class="output-display"></div>
    </div>

    <div class="tables">
      <!-- Left table container: Letter mappings + Encrypt button below -->
      <div class="table-container">
        <h3>Letter Mappings</h3>
        <table id="letterMappings">
          <thead>
            <tr>
              <th colspan="26">Map each letter to its substitution</th>
            </tr>
          </thead>
          <tbody>
            <!-- Letter mappings will be generated here -->
          </tbody>
        </table>
        <div class="button-row">
          <button onclick="encrypt()">Encrypt</button>
          <button onclick="decrypt()">Decrypt</button>
        </div>
      </div>
      <!-- Right table container: Word frequency + Analyze button below -->
      <div class="table-container">
        <h3>Word Frequency Analysis</h3>
        <table id="wordFrequency">
          <thead>
            <tr>
              <th>Word</th>
              <th>Frequency</th>
            </tr>
          </thead>
          <tbody>
            <!-- Default row: Always display example row -->
            <tr>
              <td><span class="clickable" onclick="highlightWord('example')">example</span></td>
              <td>5</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Hashing function box -->
    <div class="hashing-container">
      <h3>Hash Collision Game</h3>
      <p>Find an input that produces the same hash as the target!</p>
      <div class="hashing-box">
        <textarea id="hashInput" placeholder="Type here to generate hash..." oninput=updateHash()></textarea>
        <div class="output-container">
          <label>Hash Output:</label>
          <div id="hashOutput" class="output-display"></div>
        </div>
      </div>
      <p id="hashResult"></p>
      <button onclick="checkHashCollision()">Check Collision</button>
    </div>

    <!-- Python Sandbox -->
    <div class="python-sandbox">
      <h3>Python Sandbox</h3>
      <div class="sandbox-container">
        <textarea id="pythonCode" placeholder="Write your Python code here..."></textarea>
        <div class="sandbox-controls">
          <button onclick="runPythonCode()">Run Code</button>
          <button onclick="clearPythonOutput()">Clear Output</button>
        </div>
        <div class="sandbox-output">
          <h4>Output:</h4>
          <div id="pythonOutput"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
</body>
</html>